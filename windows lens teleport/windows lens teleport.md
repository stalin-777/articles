# –ö–∞–∫ –ø–æ–¥—Ä—É–∂–∏—Ç—å Windows, Lens –∏ Teleport

–¢—ç–≥–∏: #windows #lens #teleport #tsh #kubernetes

–ï—Å–ª–∏ –≤—ã –∫–∞–∫ —è, –∏ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ "–Ω–µ—Ç—Ä—É—à–Ω—ã–µ" –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã –Ω–µ —Å–ø–µ—à–∏—Ç–µ —É—Ö–æ–¥–∏—Ç—å —Å Windows –Ω–∞ Linux –∏–ª–∏ Mac, –∞ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π WSL2 –≤–∞—Å –±–µ–ª–µ–µ —á–µ–º —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç, —Ç–æ –≤—ã –∫–∞–∫ —Ä–∞–∑ –ø–æ –∞–¥—Ä–µ—Å—É.
–Ø –Ω–µ —è–≤–ª—è—é—Å—å —ç–∫—Å–ø–µ—Ä—Ç–æ–º –Ω–∏ –≤ –æ–¥–Ω–æ–º –∏–∑ —ç—Ç–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –Ω–æ –≤ –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç –º–æ–µ–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–µ—Å–∫–æ–π –∂–∏–∑–Ω–∏ –≤–æ–∑–Ω–∏–∫–ª–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –∫–ª–∞—Å—Ç–µ—Ä—É Kubernetes —Å –ø–æ–º–æ—â—å—é Lens, —Ç.–∫. –Ω–µ –º–æ–≥—É —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è kubectl –æ—á–µ–Ω—å —É–¥–æ–±–Ω–æ. –ü–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–∞ —ç—Ç–æ—Ç —Å—á–µ—Ç, –∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –º–Ω–µ –Ω–∞–π—Ç–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å. –ü–æ—ç—Ç–æ–º—É —Ä–µ—à–∏–ª –Ω–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ—é.
–ó–∞–±–µ–≥–∞—è –≤–ø–µ—Ä–µ–¥, —Å–∫–∞–∂—É, —á—Ç–æ –º–æ—è –≥–ª–∞–≤–Ω–∞—è –æ—à–∏–±–∫–∞ –±—ã–ª–∞ –≤ —Ç–æ–º, —á—Ç–æ –¥–ª—è Lens —è –ø—ã—Ç–∞–ª—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ Kubernetes, –∫–æ—Ç–æ—Ä—ã–π –ª–µ–∂–∞–ª –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ WSL2. –ü–æ—á–µ–º—É? –ü–æ—Ç–æ–º—É —á—Ç–æ –¥—É–º–∞–ª, —á—Ç–æ Lens –º–æ–∂–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å WSL2 —Ç–∞–∫–∂–µ, –∫–∞–∫ Docker Desktop. –ù–æ (—à–æ–∫ –∫–æ–Ω—Ç–µ–Ω—Ç) —ç—Ç–æ –æ–∫–∞–∑–∞–ª–æ—Å—å –Ω–µ —Ç–∞–∫. –í–Ω—è—Ç–Ω–æ–≥–æ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —ç—Ç–æ–º—É —è –Ω–∞–π—Ç–∏ –Ω–µ —Å–º–æ–≥, –Ω–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–æ–≤–µ—Ç:  –Ω–µ –ø—ã—Ç–∞–π—Ç–µ—Å—å —Ç–∞–∫ –¥–µ–ª–∞—Ç—å (–∏–ª–∏ –ø—ã—Ç–∞–π—Ç–µ—Å—å –∏, –µ—Å–ª–∏ —É –≤–∞—Å –ø–æ–ª—É—á–∏–ª–æ—Å—å, –Ω–∞–ø–∏—à–∏—Ç–µ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ö). –ù–µ —Å–º–æ—Ç—Ä—è –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–∞–∑–ª–∏—á–∏–π –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö, Lens —Ä–∞–±–æ—Ç–∞–ª —Ç–æ–ª—å–∫–æ —Å —Ç–µ–º –∫–æ–Ω—Ñ–∏–≥–æ–º, –∫–æ—Ç–æ—Ä—ã–π –ª–µ–∂–∞–ª –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ Windows.
![1](img20231111020819.png)

–ò—Ç–∞–∫, —Ä–∞–∑–±–µ—Ä–µ–º –≤—Å–µ –ø–æ —à–∞–≥–∞–º:

1. –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ–∫—Å–∏ Teleport –≤–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —É—Ç–∏–ª–∏—Ç–∞ `tsh`. –¢–∞, –∫–æ—Ç–æ—Ä—É—é –≤—ã, –≤–æ–∑–º–æ–∂–Ω–æ, —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –≤ WSL2 –Ω–µ –ø–æ–π–¥–µ—Ç, –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É—Ç–∏–ª–∏—Ç—É –¥–ª—è Windows. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º —Å–∞–π—Ç–µ, –Ω–æ —è —Ç–∞–∫–∂–µ –ø—Ä–æ–¥—É–±–ª–∏—Ä—É—é –µ–µ –∑–¥–µ—Å—å.
   –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏¬†`tsh`–≤ Windows –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤¬†**PowerShell**¬†(—ç—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –Ω–µ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ Windows¬†`cmd.exe`):
   –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å TLS –Ω–∞ TLS 1.2 (—Ç—Ä–µ–±—É–µ—Ç—Å—è –≤ Windows Server 2016 –∏ –±–æ–ª–µ–µ —Ä–∞–Ω–Ω–∏—Ö –≤–µ—Ä—Å–∏—è—Ö).
```
[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
```
–ü–æ–ª—É—á–∏—Ç–µ –æ–∂–∏–¥–∞–µ–º—É—é –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é —Å—É–º–º—É –¥–ª—è –ø–∞–∫–µ—Ç–∞ Windows tsh.
–í–µ—Ä—Å–∏—è –∫–ª–∏–µ–Ω—Ç–∞ `teleport` –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–µ –Ω–∏–∂–µ, —á–µ–º —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!
```
$Resp = Invoke-WebRequest https://get.gravitational.com/teleport-v14.1.1-windows-amd64-bin.zip.sha256
```
PowerShell –≤–µ—Ä–Ω–µ—Ç –¥–≤–æ–∏—á–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –ø–æ—ç—Ç–æ–º—É –≤–∞–º –Ω—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –µ–≥–æ –≤ —Å—Ç—Ä–æ–∫—É
```
[System.Text.Encoding]::UTF8.getstring($Resp.Content)
```
	`<–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞> <–∏–º—è —Ñ–∞–π–ª–∞>
```
Invoke-WebRequest -OutFile teleport-v14.1.1-windows-amd64-bin.zip -Uri https://cdn.teleport.dev/teleport-v14.1.1-windows-amd64-bin.zip
certUtil -hashfile teleport-v14.1.1-windows-amd64-bin.zip SHA256
```
SHA256 hash of teleport-v14.1.1-windows-amd64-bin.zip:
`<–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞>`
CertUtil: -hashfile command completed successfully.

–ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã —É–±–µ–¥–∏–ª–∏—Å—å –≤ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö —Å—É–º–º, –≤—ã –º–æ–∂–µ—Ç–µ –∏–∑–≤–ª–µ—á—å –∞—Ä—Ö–∏–≤. –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `teleport-v14.1.1-windows-amd64-bin\teleport\tsh.exe`
```
Expand-Archive teleport-v-v14.1.1-windows-amd64-bin.zip
cd teleport-v14.1.1-windows-amd64-bin\teleport
.\tsh.exe version
```
–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ tsh.exe –≤ —Å–≤–æ–π PATH, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ—Ä–æ—Ç–∫—É—é –∫–æ–º–∞–Ω–¥—É `tsh`, –≤–º–µ—Å—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∫–∞–∂–¥—ã–π —Ä–∞–∑ —É–∫–∞–∑—ã–≤–∞—Ç—å –ø—É—Ç—å –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É.

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ tsh –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤–∞—à–µ–≥–æ Teleport –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ —Å–æ–≥–ª–∞—Å–Ω–æ —É–∫–∞–∑–∞–Ω–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º. 
![2](img20231111034619.png)
2. –°–∫–∞—á–∞–π—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Lens —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞. –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ Lens. –í—ã–±–µ—Ä–∏—Ç–µ `"–Ω–∞—Å—Ç—Ä–æ–π–∫–∏" (–∏–∫–æ–Ω–∫–∞ "–±—É—Ä–≥–µ—Ä –º–µ–Ω—é") -> file -> preferences`, —á—Ç–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª  –∏–ª–∏ –ø–∞–ø–∫—É, –æ—Ç–∫—É–¥–∞ Lens –±—É–¥–µ—Ç —á–∏—Ç–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ Kubernetes. –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é "Add Cluster". 
![3](img20231111031755.png)

–í —É–∫–∞–∑–∞–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–æ–ª–∂–µ–Ω –ª–µ–∂–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è:

```yml
apiVersion: v1
clusters:
- cluster:
    certificate-authority-data: ${CLUSTER_CA}
    server: ${TELEPORT_ENDPOINT}
    tls-server-name: ${TELEPORT_ENDPOINT} 
  name: ${CLUSTER_NAME}
contexts:
- context:
    cluster: ${CLUSTER_NAME}
    user: ${USER_NAME}
  name: ${CONTEXT_NAME}
current-context: ${CONTEXT_NAME}
kind: Config
preferences: {}
users:
- name: ${USER_NAME}
  user:
    exec:
      apiVersion: client.authentication.k8s.io/v1beta1
      args:
      - kube
      - credentials
      - --kube-cluster=${KUBE_CLUSTER}
      - --teleport-cluster=${CLUSTER_NAME}
      - --proxy=${TELEPORT_HOST}:${TELEPORT_PORT}
      command: C:\Users\user\teleport-v12.4.23-windows-amd64-bin\teleport\tsh.exe
      env: null
      provideClusterInfo: false
```

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–æ—Å—Ç—É–ø –∫ Kubernetes –∏–∑ –≤–∞—à–µ–≥–æ WSL2, –º–æ–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ –æ—Ç—Ç—É–¥–∞, –∑–∞–º–µ–Ω–∏–≤ —Ç–æ–ª—å–∫–æ `command` –¥–ª—è –≤—ã–∑–æ–≤–∞ –≤–∞—à–µ–≥–æ tsh-–∫–ª–∏–µ–Ω—Ç–∞.

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø –∫ –≤–∞—à–µ–º—É –∫–ª–∞—Å—Ç–µ—Ä—É Kubernetes —á–µ—Ä–µ–∑ Lens, –≥–¥–µ –≤—ã —Å–º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å, —É–ø—Ä–∞–≤–ª—è—Ç—å –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã –∫–ª–∞—Å—Ç–µ—Ä–∞, –∞ —Ç–∞–∫–∂–µ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –≤–∞—à–∏–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏. –ù–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –¥–µ–ª–∞—Ç—å –∫–æ–Ω–Ω–µ–∫—Ç –∫ tsh –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã. –î—É–º–∞—é, —ç—Ç–æ –æ—á–µ–≤–∏–¥–Ω–æ, –Ω–æ –º–∞–ª–æ –ª–∏ üòÑ

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Kubernetes —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ Teleport –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–º–µ—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –≤ Teleport. –ï—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Ç —Ç–∞–∫–∏—Ö –ø—Ä–∞–≤, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É —Å–∏—Å—Ç–µ–º—ã.
